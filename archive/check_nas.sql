WITH cte_counts AS (
SELECT 
    COUNTIF(ANSPRACHE IS NULL) AS  ANSPRACHE_NA,
    COUNTIF(ANSPRACHE_MARKETING_IMPUTED IS NULL) AS  MARKETING_NA,
    COUNTIF(FRACTION_SOLDOUT IS NULL) AS SOLDOUT_NA,
    COUNT(*) AS TOTAL
FROM `brain-flash-dev.dagster_common.CN_data_to_fetch`
WHERE TEST_ITEM_COMMUNICATIONKEY != TWIN_ITEM_COMMUNICATIONKEY 
)

SELECT
ROUND(ANSPRACHE_NA/TOTAL,4) * 100 AS ANSPRACHE_NA_PERC,
ROUND(MARKETING_NA/TOTAL,4) * 100 AS MARKETING_NA_PERC,
ROUND(SOLDOUT_NA/TOTAL,4) * 100 AS SOLDOUT_NA_PERC

FROM cte_counts